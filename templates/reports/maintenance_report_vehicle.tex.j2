\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{geometry}
\usepackage{booktabs}
\geometry{a4paper, margin=2cm}

\title{Maintenance Report\\{{ vehicle_name }}}
\date{\today}
\author{FleetPredict Pro}

\begin{document}
\maketitle

\section*{Vehicle data}
\begin{tabular}{ll}
License plate: & {{ license_plate }} \\
VIN: & {{ vin }} \\
Type: & {{ vehicle_type }} \\
Current mileage: & {{ current_mileage }} km \\
\end{tabular}

\section*{Maintenance history}
\begin{tabular}{p{3.5cm}p{1.8cm}p{1.6cm}p{1.6cm}p{1.4cm}p{1.8cm}}
\toprule
Task & Type & Scheduled & Completed & Cost & Status \\
\midrule
{% for t in tasks %}
{{ escape(t.title) }} & {{ escape(t.get_maintenance_type_display()) }} & {{ t.scheduled_date.strftime('%Y-%m-%d') }} & {{ t.completion_date.strftime('%Y-%m-%d') if t.completion_date else '---' }} & {{ t.actual_cost if t.actual_cost is not none else '---' }} & {{ escape(t.get_status_display()) }} \\
{% endfor %}
\bottomrule
\end{tabular}

\section*{Recent alerts}
{% if alerts %}
\begin{tabular}{p{2.2cm}p{1.5cm}p{6cm}p{2cm}}
\toprule
Severity & Type & Message & Date \\
\midrule
{% for a in alerts %}
{{ escape(a.get_severity_display()) }} & {{ escape(a.get_alert_type_display()) }} & {{ escape(a.message) }} & {{ a.created_at.strftime('%Y-%m-%d %H:%M') if a.created_at else '---' }} \\
{% endfor %}
\bottomrule
\end{tabular}
{% else %}
No recent alerts.
{% endif %}

\section*{Latest telemetry}
{% if last_telemetry %}
Last reading: {{ last_telemetry.timestamp.strftime('%Y-%m-%d %H:%M') if last_telemetry and last_telemetry.timestamp else '---' }}\\
Engine: {{ 'On' if last_telemetry and last_telemetry.engine_temperature_c is not none else 'Off/N/A' }}\\
Temperature: {{ last_telemetry.engine_temperature_c if last_telemetry and last_telemetry.engine_temperature_c is not none else '---' }} Â°C\\
Fuel: {{ last_telemetry.fuel_level_pct if last_telemetry and last_telemetry.fuel_level_pct is not none else '---' }} \%
{% else %}
No recent telemetry data.
{% endif %}

\end{document}
